# ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –í–´–ü–û–õ–ù–ï–ù–´ - MapMon v0.5

## üöÄ –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

–£—Å–ø–µ—à–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –¥–≤–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞ MapMon v0.5:

1. **–ù–µ—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å MQTT –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã** ‚úÖ
2. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫ –≥—Ä–∞—Ñ–∏–∫–æ–≤** ‚úÖ

---

## üîß 1. –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï MQTT –ê–†–•–ò–¢–ï–ö–¢–£–†–´

### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞
- ESP32 –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª TCP MQTT (–ø–æ—Ä—Ç 1883)
- –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø—ã—Ç–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è —á–µ—Ä–µ–∑ WebSocket MQTT (–ø–æ—Ä—Ç—ã 8081/8084)
- –ü—Ä–æ—Ç–æ–∫–æ–ª—ã –±—ã–ª–∏ –Ω–µ—Å–æ–≤–º–µ—Å—Ç–∏–º—ã

### ‚úÖ –†–µ—à–µ–Ω–∏–µ
**–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ "MQTT —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ":**
```
ESP32 ‚Üí TCP MQTT (1883) ‚Üí –°–µ—Ä–≤–µ—Ä MQTT –ö–æ–ª–ª–µ–∫—Ç–æ—Ä ‚Üí SQLite ‚Üí API ‚Üí –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
```

### üìã –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:

#### –£–¥–∞–ª–µ–Ω–æ –∏–∑ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
- ‚ùå `composables/useMqttSettings.ts` - –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–µ–Ω
- ‚ùå MQTT –∫–ª–∏–µ–Ω—Ç –≤ `pages/history.vue` - –∑–∞–º–µ–Ω–µ–Ω –Ω–∞ API polling
- ‚ùå WebSocket MQTT –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- ‚ùå –ò–º–ø–æ—Ä—Ç—ã mqtt.js –≤ –±—Ä–∞—É–∑–µ—Ä–Ω–æ–º –∫–æ–¥–µ

#### –û–±–Ω–æ–≤–ª–µ–Ω–æ –¥–ª—è API:
- ‚úÖ `pages/history.vue` - —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `/api/telemetry/latest`
- ‚úÖ `components/AppHeader.vue` - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç API —Å—Ç–∞—Ç—É—Å
- ‚úÖ `components/SettingsModal.vue` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ API –≤–º–µ—Å—Ç–æ MQTT

#### –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
- ‚úÖ `server-backup/mqtt-collector.cjs` - —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –∏ —Ä–∞–Ω—å—à–µ
- ‚úÖ TCP MQTT –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ test.mosquitto.org:1883
- ‚úÖ –ó–∞–ø–∏—Å—å –≤ SQLite —á–µ—Ä–µ–∑ SQLiteManager
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö —Ç–æ–ø–∏–∫–æ–≤ ESP32 (car, vehicles/+/telemetry, etc.)

---

## üìä 2. –£–î–ê–õ–ï–ù–ò–ï –î–£–ë–õ–ò–†–û–í–ê–ù–ò–Ø –ì–†–ê–§–ò–ö–û–í

### ‚ùå –ü—Ä–æ–±–ª–µ–º–∞
- –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –¥–≤–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏: ApexCharts –∏ ECharts
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è —Ç–æ–ª—å–∫–æ ECharts
- ApexCharts –∑–∞–Ω–∏–º–∞–ª –º–µ—Å—Ç–æ –≤ bundle

### ‚úÖ –†–µ—à–µ–Ω–∏–µ

#### –£–¥–∞–ª–µ–Ω–æ:
- ‚ùå `apexcharts` –∏–∑ package.json dependencies
- ‚ùå `vue3-apexcharts` –∏–∑ package.json dependencies  
- ‚ùå `plugins/apexcharts.client.ts` - –ø–ª–∞–≥–∏–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é —É–¥–∞–ª–µ–Ω

#### –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ:
- ‚úÖ `echarts` –æ—Å—Ç–∞–µ—Ç—Å—è –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–π –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π –≥—Ä–∞—Ñ–∏–∫–æ–≤
- ‚úÖ –í—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –≥—Ä–∞—Ñ–∏–∫–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

---

## üß™ –í–ê–õ–ò–î–ê–¶–ò–Ø –ò–ó–ú–ï–ù–ï–ù–ò–ô

–°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç `validate-changes.cjs` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:

```bash
node validate-changes.cjs
```

### ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏:
- ‚úÖ ApexCharts —É–¥–∞–ª–µ–Ω –∏–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- ‚úÖ ECharts –æ—Å—Ç–∞–µ—Ç—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö  
- ‚úÖ Test —Å–∫—Ä–∏–ø—Ç –¥–æ–±–∞–≤–ª–µ–Ω
- ‚úÖ ApexCharts –ø–ª–∞–≥–∏–Ω —É–¥–∞–ª–µ–Ω
- ‚úÖ useMqttSettings.ts —É–¥–∞–ª–µ–Ω
- ‚úÖ MQTT –∫–ª–∏–µ–Ω—Ç —É–¥–∞–ª–µ–Ω –∏–∑ pages/history.vue
- ‚úÖ API –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ pages/history.vue
- ‚úÖ MQTT –∫–æ–ª–ª–µ–∫—Ç–æ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- ‚úÖ SQLite –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞
- ‚úÖ AppHeader.vue –∏—Å–ø–æ–ª—å–∑—É–µ—Ç API
- ‚úÖ SettingsModal.vue –∏—Å–ø–æ–ª—å–∑—É–µ—Ç API

---

## üéØ –ù–û–í–ê–Ø –ê–†–•–ò–¢–ï–ö–¢–£–†–ê

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö:
1. **ESP32** –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ ‚Üí TCP MQTT (–ø–æ—Ä—Ç 1883)
2. **–°–µ—Ä–≤–µ—Ä MQTT –∫–æ–ª–ª–µ–∫—Ç–æ—Ä** –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ ‚Üí –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ SQLite
3. **API —Å–µ—Ä–≤–µ—Ä** —á–∏—Ç–∞–µ—Ç –∏–∑ SQLite ‚Üí –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç REST endpoints
4. **–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ API ‚Üí –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤ –±—Ä–∞—É–∑–µ—Ä–µ

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
- üîí **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**: MQTT —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- üìä **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å**: –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ SQLite –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- üöÄ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –Ω–µ—Ç MQTT –∫–ª–∏–µ–Ω—Ç–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
- üì± **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–µ–∑–¥–µ –≥–¥–µ –µ—Å—Ç—å HTTP
- üõ†Ô∏è **–ü—Ä–æ—Å—Ç–æ—Ç–∞**: ESP32 –∫–æ–¥ –Ω–µ –Ω—É–∂–Ω–æ –º–µ–Ω—è—Ç—å

---

## üìã –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

–î–≤–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã —Ä–µ—à–µ–Ω—ã. –î–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ —É–ª—É—á—à–µ–Ω–∏—è –º–æ–∂–Ω–æ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å:

1. **PM2 Configuration** - –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ (2 –≤–º–µ—Å—Ç–æ 3)
2. **ESP32 Topic Standardization** - —É–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–æ–ø–∏–∫–æ–≤
3. **Duplicate Server Implementations** - –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ server/ –∏ server-backup/
4. **Unused Files Cleanup** - —É–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤

---

## üöÄ –ó–ê–ü–£–°–ö –ü–†–û–ï–ö–¢–ê

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –ø—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ:

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
npm install

# –ó–∞–ø—É—Å–∫ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
npm run dev

# –ó–∞–ø—É—Å–∫ MQTT –∫–æ–ª–ª–µ–∫—Ç–æ—Ä–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
cd server-backup
node mqtt-collector.cjs

# –ó–∞–ø—É—Å–∫ API —Å–µ—Ä–≤–µ—Ä–∞  
node api-server.cjs
```

**–í–∞–∂–Ω–æ**: MQTT –∫–æ–ª–ª–µ–∫—Ç–æ—Ä –¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ –¥–ª—è —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –æ—Ç ESP32!

---

*–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ SQLite, MQTT —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ, –±—Ä–∞—É–∑–µ—Ä —Å–ª—É–∂–∏—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–º –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è.* 